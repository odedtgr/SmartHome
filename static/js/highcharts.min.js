var dynamicChart,channelsLoaded=0,channelKeys=[];channelKeys.push({channelNumber:112955,name:"Temperature",key:"8UKAQRZZVL67BGVI",fieldList:[{field:3,axis:"C"}]});var myOffset=(new Date).getTimezoneOffset();function getChartDate(a){return Date.UTC(a.substring(0,4),a.substring(5,7)-1,a.substring(8,10),a.substring(11,13),a.substring(14,16),a.substring(17,19))-6E4*myOffset}
$(document).ready(function(){function a(b,c,a,d){$.getJSON("https://www.thingspeak.com/channels/"+c+"/feed.json?callback=?&amp;offset=0&amp;results=8000;key="+a,function(a){"-1"==a&&($("#chart-container").append("This channel is not public.  To embed charts, the channel must be public or a read key must be specified."),window.console&&console.log("Thingspeak Data Loading Error"));for(var c=0;c<d.length;c++){d[c].data=[];for(var f=0;f<a.feeds.length;f++){var g=[],e=eval("data.feeds["+f+"].field"+d[c].field);
g[0]=getChartDate(a.feeds[f].created_at);g[1]=parseFloat(e);isNaN(parseInt(e))||d[c].data.push(g)}d[c].name=eval("data.channel.field"+d[c].field)}channelKeys[b].fieldList=d;channelKeys[b].loaded=!0;channelsLoaded++;channelsLoaded==channelKeys.length&&k()}).fail(function(){alert("getJSON request failed! ")})}function k(){for(var b={chart:{renderTo:"chart-container",zoomType:"x"},rangeSelector:{buttons:[{count:1,type:"hour",text:"1H"},{count:12,type:"hour",text:"12H"},{count:1,type:"day",text:"D"},
{count:1,type:"week",text:"W"},{count:1,type:"month",text:"M"},{count:1,type:"year",text:"Y"},{type:"all",text:"All"}],inputEnabled:!1,selected:2},title:{text:""},plotOptions:{line:{gapSize:5},series:{connectNulls:!0,marker:{radius:2},animation:!1,step:!1,turboThrehold:1E3,borderWidth:0}},tooltip:{valueDecimals:1,valueSuffix:"",xDateFormat:"%Y-%m-%d<br/>%H:%M:%S %p"},xAxis:{type:"datetime",ordinal:!1,min:Date.UTC(2013,2,28),dateTimeLabelFormats:{hour:"%I %p",minute:"%l:%M %p"},title:{text:"LeftAxis"}},
yAxis:[{title:{text:""},id:"R"},{title:{text:"Temperature"},opposite:!0,id:"C"}],legend:{enabled:!1},navigator:{baseSeries:0},series:[]},c=0;c<channelKeys.length;c++)for(var a=0;a<channelKeys[c].fieldList.length;a++)b.series.push({data:channelKeys[c].fieldList[a].data,index:channelKeys[c].fieldList[a].series,yAxis:channelKeys[c].fieldList[a].axis,name:channelKeys[c].fieldList[a].name});b.xAxis.title.text="Date";dynamicChart=new Highcharts.StockChart(b)}for(var h=0,b=0;b<channelKeys.length;b++)for(var e=
0;e<channelKeys[b].fieldList.length;e++)channelKeys[b].fieldList[e].series=h,h++;for(b=0;b<channelKeys.length;b++)channelKeys[b].loaded=!1,a(b,channelKeys[b].channelNumber,channelKeys[b].key,channelKeys[b].fieldList)});
